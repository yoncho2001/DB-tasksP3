CREATE DATABASE FURNITURE_C
GO
USE FURNITURE_C
GO

DROP TABLE CUSTOMER
DROP TABLE ORDER_T
DROP TABLE ORDER_LINE
DROP TABLE PRODUCT

CREATE TABLE CUSTOMER (
 CUSTOMER_ID INT IDENTITY(1,1) NOT NULL,
 CUSTOMER_NAME CHAR(50) NOT NULL,
 CUSTOMER_ADDRESS CHAR(50) NOT NULL,
 CUSTOMER_CITY CHAR(20) NOT NULL,
 CITY_CODE CHAR(4) NOT NULL
);

CREATE TABLE ORDER_T (
 ORDER_ID INT NOT NULL UNIQUE,
 ORDER_DATE DATETIME NOT NULL,
 CUSTOMER_ID INT NOT NULL,
);

CREATE TABLE ORDER_LINE (
 ORDER_ID INT NOT NULL,
 PRODUCT_ID INT NOT NULL,
 ORDRERED_QUANTITY INT NOT NULL,
);

CREATE TABLE PRODUCT (
 PRODUCT_ID INT NOT NULL UNIQUE,
 PRODUCT_DESCRIPTION VARCHAR(50) NOT NULL,
 PRODUCT_FINISH CHAR(50) CHECK (PRODUCT_FINISH IN 
 ('череша', 'естествен ясен', 'бял ясен', 'червен дъб', 'естествен дъб', 'орех'))NOT NULL,
 STANDARD_PRICE DECIMAL(10, 2) NOT NULL,
 PRODUCT_LINE_ID INT NOT NULL
);

ALTER TABLE CUSTOMER ADD CONSTRAINT PK_CUSTOMER PRIMARY KEY (CUSTOMER_ID);

ALTER TABLE ORDER_T ADD CONSTRAINT PK_ORDER_T PRIMARY KEY (ORDER_ID);

ALTER TABLE ORDER_LINE ADD CONSTRAINT PK_ORDER_LINE PRIMARY KEY (ORDER_ID,PRODUCT_ID);

ALTER TABLE PRODUCT ADD CONSTRAINT PK_PRODUCT PRIMARY KEY (PRODUCT_ID);

ALTER TABLE ORDER_T ADD CONSTRAINT FK_CUSTOMER_ID FOREIGN KEY(CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_ID);

ALTER TABLE ORDER_LINE ADD CONSTRAINT FK_ORDER_ID FOREIGN KEY(ORDER_ID) REFERENCES ORDER_T(ORDER_ID);

ALTER TABLE ORDER_LINE ADD CONSTRAINT FK_PRODUCT_ID FOREIGN KEY(PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID);

/*DATA*/
insert into CUSTOMER values
('Иван Петров', 'ул. Лавеле 8', 'София', '1000'),
('Камелия Янева', 'ул. Иван Шишман 3', 'Бургас', '8000'),
('Васил Димитров', 'ул. Абаджийска 87', 'Пловдив', '4000'),
('Ани Милева', 'бул. Владислав Варненчик 56', 'Варна','9000');

SELECT * FROM PRODUCT

insert into PRODUCT values
(1000, 'офис бюро', 'череша', 195, 10),
(1001, 'директорско бюро', 'червен дъб', 250, 10),
(2000, 'офис стол', 'череша', 75, 20),
(2001, 'директорски стол', 'естествен дъб', 129, 20),
(3000, 'етажерка за книги', 'естествен ясен', 85, 30),
(4000, 'настолна лампа', 'естествен ясен', 35, 40);

insert into ORDER_T values
(100, '2013-01-05', 1),
(101, '2013-12-07', 2),
(102, '2014-10-03', 3),
(103, '2014-10-08', 2),
(104, '2015-10-05', 1),
(105, '2015-10-05', 4),
(106, '2015-10-06', 2),
(107, '2016-01-06', 1);

insert into ORDER_LINE values
(100, 4000, 1),
(101, 1000, 2),
(101, 2000, 2),
(102, 3000, 1),
(102, 2000, 1),
(106, 4000, 1),
(103, 4000, 1),
(104, 4000, 1),
(105, 4000, 1),
(107, 4000, 1);


